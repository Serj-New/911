{"version":3,"file":"commonHelpers2.js","sources":["../src/js/shopping-list_page/shopping-list.js"],"sourcesContent":["import Pagination from 'tui-pagination';\nimport 'tui-pagination/dist/tui-pagination.css';\nimport { handleAddBtnClick, handleGetBtnClick, handleDelBtnClick } from './local-storage'; // видалити handleAddBtnClick\nimport { createMarkup } from '../book-modal';\n\nconst refs = {\n    shopListEmptElem: document.querySelector(\".shop-list-empty\"),\n    shopListElem: document.querySelector(\".shop-list\"),\n    paginationElem: document.getElementById(\"pagination\"),\n    pageHeader: document.querySelector(\".header-home\"),\n}\n\nconst pagination = new Pagination('pagination', {\n    totalItems: handleGetBtnClick().length,\n    itemsPerPage: window.innerWidth < 768 ? 4 : 3, \n    visiblePages: window.innerWidth < 768 ? 2 : 3,\n    centerAlign: true,\n});\nrenderWithPagination();\n\nwindow.addEventListener(\"resize\", onResize);\nfunction onResize() {\n    const targetPage = pagination.getCurrentPage();\n    pagination.movePageTo(targetPage);\n}\n\npagination.on('afterMove', (event) => {\n    const itemsPerPage = window.innerWidth < 768 ? 4 : 3;\n    pagination.setItemsPerPage(itemsPerPage);\n    renderWithPagination();\n}); \n\nfunction renderWithPagination() {\n    if (checkIfEmpty()) {\n        const currentPage = pagination.getCurrentPage();\n        const itemsPerPage = window.innerWidth < 768 ? 4 : 3;\n        const startIndex = (currentPage - 1) * itemsPerPage;\n        const endIndex = startIndex + itemsPerPage;\n        const booksToRender = handleGetBtnClick().slice(startIndex, endIndex);\n        renderShopList(booksToRender);\n    }\n}\n\nfunction renderShopList(booksList) {\n    const deleteBtnElements = document.querySelectorAll(\".shop-list-delete-btn\");\n    deleteBtnElements.forEach(button => {\n        button.removeEventListener(\"click\", onDeleteBtnClick);\n    });\n    const markup = shopListTemplate(booksList);\n    refs.shopListElem.innerHTML = markup;\n    const newDeleteBtnElements = document.querySelectorAll(\".shop-list-delete-btn\");\n    newDeleteBtnElements.forEach(button => {\n        button.addEventListener(\"click\", onDeleteBtnClick);\n    });\n}\nfunction checkIfEmpty() {\n    if (handleGetBtnClick().length === 0) {\n        refs.shopListElem.classList.add(\"is-hidden\");\n        refs.paginationElem.classList.add(\"is-hidden\");\n        refs.shopListEmptElem.classList.remove(\"is-hidden\");\n        return false;\n    } else {\n        refs.shopListElem.classList.remove(\"is-hidden\");\n        refs.shopListEmptElem.classList.add(\"is-hidden\");\n        refs.paginationElem.classList.remove(\"is-hidden\");\n        return true;\n    }\n}\nfunction onDeleteBtnClick(event) {\n    const id = event.target.closest(\".shop-list-item\").id;\n    handleDelBtnClick(id);\n    const bookToRemove = document.getElementById(id);\n    bookToRemove.parentNode.removeChild(bookToRemove);\n    const userCurrentPage = pagination.getCurrentPage();\n    pagination.reset(handleGetBtnClick().length);\n    renderWithPagination();\n    pagination.movePageTo(userCurrentPage);\n    checkIfEmpty();\n}\n\nfunction shopListTemplate(books) {\n    return books.map(bookTemplate).join(\"\");\n}\n\nfunction bookTemplate(book) {\n    const { _id, book_image, title, list_name, description, author, amazon_product_url, buy_links } = book;\n\n    return `<li class=\"shop-list-item\" id=\"${_id}\">\n        <img class=\"shop-list-img\"\n            src=\"${book_image}\"\n            alt=\"${title}\" />  \n        <div class=\"book-info\">\n        <h1 class=\"book-title\">${title}</h1>\n        <p class=\"book-category\">${list_name}</p>\n        <p class=\"book-description\">${description}</p>\n        <div class=\"card-footer\">\n        <p class=\"book-author\">${author}</p>\n        <ul class=\"book-shop-links\">\n        <li><a href=\"${amazon_product_url}\" target=\"_blank\"><img class=\"book-shop-img amazon-logo\"\n        srcset=\"\n        /img/internet-shops/amazon@1x.png 1x,\n        /img/internet-shops/amazon@2x.png 2x\" \n        src=\"/img/internet-shops/amazon@1x.png\"\n        alt=\"Amazon logo\"\n        width=\"32\"\n        height=\"11\"/></a></li>\n        <li><a class=\"book-shop-link\" href=\"${buy_links[1].url}\" target=\"_blank\"><img class=\"book-shop-img apple-books-logo\"\n        srcset=\"\n        /img/internet-shops/book@1x.png 1x,\n        /img/internet-shops/book@2x.png 2x\" \n        src=\"/img/internet-shops/book@1x.png\"\n        alt=\"Apple Books logo\"\n        width=\"16\"\n        height=\"16\"/></a></li>\n        </ul>\n        </div> \n        </div>\n        <button class=\"shop-list-delete-btn\"><svg class=\"delete-btn-icon\">\n                  <use href=\"/img/icons.svg#icon-trash\"></use>\n                </svg></button>\n    </li>`;\n}\n\nwindow.addEventListener('DOMContentLoaded', (event) => {\n    refs.pageHeader.dataset.pageName = 'shopping-list';\n});\n\n\n"],"names":["refs","pagination","Pagination","handleGetBtnClick","renderWithPagination","onResize","targetPage","event","itemsPerPage","checkIfEmpty","currentPage","startIndex","endIndex","booksToRender","renderShopList","booksList","button","onDeleteBtnClick","markup","shopListTemplate","id","handleDelBtnClick","bookToRemove","userCurrentPage","books","bookTemplate","book","_id","book_image","title","list_name","description","author","amazon_product_url","buy_links"],"mappings":"2GAKA,MAAMA,EAAO,CACT,iBAAkB,SAAS,cAAc,kBAAkB,EAC3D,aAAc,SAAS,cAAc,YAAY,EACjD,eAAgB,SAAS,eAAe,YAAY,EACpD,WAAY,SAAS,cAAc,cAAc,CACrD,EAEMC,EAAa,IAAIC,EAAW,aAAc,CAC5C,WAAYC,EAAiB,EAAG,OAChC,aAAc,OAAO,WAAa,IAAM,EAAI,EAC5C,aAAc,OAAO,WAAa,IAAM,EAAI,EAC5C,YAAa,EACjB,CAAC,EACDC,IAEA,OAAO,iBAAiB,SAAUC,CAAQ,EAC1C,SAASA,GAAW,CAChB,MAAMC,EAAaL,EAAW,iBAC9BA,EAAW,WAAWK,CAAU,CACpC,CAEAL,EAAW,GAAG,YAAcM,GAAU,CAClC,MAAMC,EAAe,OAAO,WAAa,IAAM,EAAI,EACnDP,EAAW,gBAAgBO,CAAY,EACvCJ,GACJ,CAAC,EAED,SAASA,GAAuB,CAC5B,GAAIK,EAAY,EAAI,CAChB,MAAMC,EAAcT,EAAW,iBACzBO,EAAe,OAAO,WAAa,IAAM,EAAI,EAC7CG,GAAcD,EAAc,GAAKF,EACjCI,EAAWD,EAAaH,EACxBK,EAAgBV,EAAmB,EAAC,MAAMQ,EAAYC,CAAQ,EACpEE,EAAeD,CAAa,CAC/B,CACL,CAEA,SAASC,EAAeC,EAAW,CACL,SAAS,iBAAiB,uBAAuB,EACzD,QAAQC,GAAU,CAChCA,EAAO,oBAAoB,QAASC,CAAgB,CAC5D,CAAK,EACD,MAAMC,EAASC,EAAiBJ,CAAS,EACzCf,EAAK,aAAa,UAAYkB,EACD,SAAS,iBAAiB,uBAAuB,EACzD,QAAQF,GAAU,CACnCA,EAAO,iBAAiB,QAASC,CAAgB,CACzD,CAAK,CACL,CACA,SAASR,GAAe,CACpB,OAAIN,EAAiB,EAAG,SAAW,GAC/BH,EAAK,aAAa,UAAU,IAAI,WAAW,EAC3CA,EAAK,eAAe,UAAU,IAAI,WAAW,EAC7CA,EAAK,iBAAiB,UAAU,OAAO,WAAW,EAC3C,KAEPA,EAAK,aAAa,UAAU,OAAO,WAAW,EAC9CA,EAAK,iBAAiB,UAAU,IAAI,WAAW,EAC/CA,EAAK,eAAe,UAAU,OAAO,WAAW,EACzC,GAEf,CACA,SAASiB,EAAiBV,EAAO,CAC7B,MAAMa,EAAKb,EAAM,OAAO,QAAQ,iBAAiB,EAAE,GACnDc,EAAkBD,CAAE,EACpB,MAAME,EAAe,SAAS,eAAeF,CAAE,EAC/CE,EAAa,WAAW,YAAYA,CAAY,EAChD,MAAMC,EAAkBtB,EAAW,iBACnCA,EAAW,MAAME,EAAmB,EAAC,MAAM,EAC3CC,IACAH,EAAW,WAAWsB,CAAe,EACrCd,GACJ,CAEA,SAASU,EAAiBK,EAAO,CAC7B,OAAOA,EAAM,IAAIC,CAAY,EAAE,KAAK,EAAE,CAC1C,CAEA,SAASA,EAAaC,EAAM,CACxB,KAAM,CAAE,IAAAC,EAAK,WAAAC,EAAY,MAAAC,EAAO,UAAAC,EAAW,YAAAC,EAAa,OAAAC,EAAQ,mBAAAC,EAAoB,UAAAC,CAAW,EAAGR,EAElG,MAAO,kCAAkCC,CAAG;AAAA;AAAA,mBAE7BC,CAAU;AAAA,mBACVC,CAAK;AAAA;AAAA,iCAESA,CAAK;AAAA,mCACHC,CAAS;AAAA,sCACNC,CAAW;AAAA;AAAA,iCAEhBC,CAAM;AAAA;AAAA,uBAEhBC,CAAkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8CAQKC,EAAU,CAAC,EAAE,GAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAe9D,CAEA,OAAO,iBAAiB,mBAAqB3B,GAAU,CACnDP,EAAK,WAAW,QAAQ,SAAW,eACvC,CAAC"}